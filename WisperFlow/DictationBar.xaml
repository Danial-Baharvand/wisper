<Window x:Class="WisperFlow.DictationBar"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WisperFlow"
        Width="800" Height="400"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        Focusable="False"
        ShowActivated="False"
        WindowStartupLocation="Manual">
    
    <Window.Resources>
        <!-- Hint bar expand animation -->
        <Storyboard x:Key="HintExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="HintBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="HintBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Hint bar collapse animation (no From values to prevent flash) -->
        <Storyboard x:Key="HintCollapseAnimation">
            <DoubleAnimation Storyboard.TargetName="HintBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="HintBarTransform" Storyboard.TargetProperty="Y"
                           To="10" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Transcript bar expand animation (same as hint bar) -->
        <Storyboard x:Key="TranscriptExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="TranscriptBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="TranscriptBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Transcript bar collapse animation (no From values to prevent flash) -->
        <Storyboard x:Key="TranscriptCollapseAnimation">
            <DoubleAnimation Storyboard.TargetName="TranscriptBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="TranscriptBarTransform" Storyboard.TargetProperty="Y"
                           To="10" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Warning bar fade in animation -->
        <Storyboard x:Key="WarningFadeInAnimation">
            <DoubleAnimation Storyboard.TargetName="WarningBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.3"/>
            <DoubleAnimation Storyboard.TargetName="WarningBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Warning bar fade out animation -->
        <Storyboard x:Key="WarningFadeOutAnimation">
            <DoubleAnimation Storyboard.TargetName="WarningBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.5"/>
            <DoubleAnimation Storyboard.TargetName="WarningBarTransform" Storyboard.TargetProperty="Y"
                           To="-5" Duration="0:0:0.5">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Main bar expand animation (for hover/recording - slightly wider than sound waves) -->
        <Storyboard x:Key="MainBarExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Width"
                           To="100" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Height"
                           To="28" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Main bar contract animation (back to pill) -->
        <Storyboard x:Key="MainBarContractAnimation">
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Width"
                           To="70" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Height"
                           To="22" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </Window.Resources>
    
    <Grid x:Name="RootGrid" VerticalAlignment="Bottom" HorizontalAlignment="Center">
        <StackPanel VerticalAlignment="Bottom">
            
            <!-- Warning Bar (separate layer, appears above transcript) -->
            <Border x:Name="WarningBar" 
                    Background="#F0ffa502" 
                    CornerRadius="8" 
                    Padding="16,8"
                    Margin="0,0,0,4"
                    Opacity="0"
                    Visibility="Collapsed"
                    HorizontalAlignment="Center">
                <Border.RenderTransform>
                    <TranslateTransform x:Name="WarningBarTransform" Y="10"/>
                </Border.RenderTransform>
                <Border.Effect>
                    <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                </Border.Effect>
                
                <TextBlock x:Name="WarningText" 
                           Text="" 
                           Foreground="#1a1a2e" 
                           FontFamily="Segoe UI Semibold" 
                           FontSize="12"
                           HorizontalAlignment="Center"/>
            </Border>
            
            <!-- Info Bar Container - overlays HintBar, TranscriptBar at same position -->
            <Grid Margin="0,0,0,4" HorizontalAlignment="Center">
                <!-- Transcript Bar - ClipToBounds ensures content doesn't overflow rounded corners -->
                <Border x:Name="TranscriptBar" 
                        Background="#F0121820" 
                        CornerRadius="8" 
                        Padding="16,8"
                        Opacity="0"
                        Visibility="Collapsed"
                        MaxHeight="280"
                        ClipToBounds="True"
                        HorizontalAlignment="Center">
                    <Border.RenderTransform>
                        <TranslateTransform x:Name="TranscriptBarTransform" Y="10"/>
                    </Border.RenderTransform>
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <!-- ScrollViewer - Hidden scrollbar to prevent layout jitter, but still scrollable -->
                    <ScrollViewer x:Name="TranscriptScrollViewer"
                                  VerticalScrollBarVisibility="Hidden"
                                  HorizontalScrollBarVisibility="Disabled">
                        <!-- TextBlock with inline cursor - same font as hint bar -->
                        <TextBlock x:Name="TranscriptText" 
                                   Foreground="#8892b0" 
                                   FontFamily="Segoe UI" 
                                   FontSize="12"
                                   FontWeight="Normal"
                                   TextWrapping="Wrap"
                                   MaxWidth="600"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Top">
                            <Run x:Name="TranscriptRun" Text=""/>
                            <InlineUIContainer x:Name="CursorContainer" BaselineAlignment="Center">
                                <Border x:Name="TypingCursor" 
                                        Width="2" Height="14" 
                                        Background="#ff6b9d" 
                                        CornerRadius="1"
                                        Visibility="Collapsed"
                                        Margin="1,0,0,0"/>
                            </InlineUIContainer>
                        </TextBlock>
                    </ScrollViewer>
                </Border>
                
                <!-- Hint Bar (shows on hover) - same position as transcript -->
                <Border x:Name="HintBar" 
                        Background="#F0121820" 
                        CornerRadius="8" 
                        Padding="16,8"
                        Opacity="0"
                        HorizontalAlignment="Center">
                    <Border.RenderTransform>
                        <TranslateTransform x:Name="HintBarTransform" Y="10"/>
                    </Border.RenderTransform>
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <TextBlock x:Name="HintText" HorizontalAlignment="Center">
                        <Run Text="Click or hold " Foreground="#8892b0" FontFamily="Segoe UI" FontSize="12"/>
                        <Run x:Name="HotkeyText" Text="caps" Foreground="#ff6b9d" FontFamily="Segoe UI Semibold" FontSize="12"/>
                        <Run Text=" to start dictating" Foreground="#8892b0" FontFamily="Segoe UI" FontSize="12"/>
                    </TextBlock>
                </Border>
            </Grid>
            
            <!-- Main Voice Bar (always visible) - pill shape when idle, expands on hover/recording -->
            <Border x:Name="MainBar" 
                    Background="#E6121820" 
                    CornerRadius="11"
                    Width="70" Height="22"
                    HorizontalAlignment="Center"
                    Cursor="Hand"
                    Margin="0,0,0,8">
                <Border.Effect>
                    <DropShadowEffect Color="Black" BlurRadius="8" Opacity="0.25" ShadowDepth="1"/>
                </Border.Effect>
                
                <!-- Voice wave bars container - animated by code based on audio level -->
                <StackPanel x:Name="VoiceBarsPanel" 
                            Orientation="Horizontal" 
                            HorizontalAlignment="Center" 
                            VerticalAlignment="Center">
                    <Rectangle x:Name="Bar1" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar2" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar3" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar4" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar5" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar6" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar7" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar8" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    <Rectangle x:Name="Bar9" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </Grid>
</Window>
