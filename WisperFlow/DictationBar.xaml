<Window x:Class="WisperFlow.DictationBar"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WisperFlow"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        Focusable="False"
        ShowActivated="False"
        WindowStartupLocation="Manual">
    
    <Window.Resources>
        <!-- Hint bar expand animation -->
        <Storyboard x:Key="HintExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="HintBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="HintBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Hint bar collapse animation (no From values to prevent flash) -->
        <Storyboard x:Key="HintCollapseAnimation">
            <DoubleAnimation Storyboard.TargetName="HintBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="HintBarTransform" Storyboard.TargetProperty="Y"
                           To="10" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Transcript bar expand animation (same as hint bar) -->
        <Storyboard x:Key="TranscriptExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="TranscriptBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="TranscriptBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Transcript bar collapse animation (no From values to prevent flash) -->
        <Storyboard x:Key="TranscriptCollapseAnimation">
            <DoubleAnimation Storyboard.TargetName="TranscriptBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="TranscriptBarTransform" Storyboard.TargetProperty="Y"
                           To="10" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Warning bar fade in animation -->
        <Storyboard x:Key="WarningFadeInAnimation">
            <DoubleAnimation Storyboard.TargetName="WarningBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.3"/>
            <DoubleAnimation Storyboard.TargetName="WarningBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Warning bar fade out animation -->
        <Storyboard x:Key="WarningFadeOutAnimation">
            <DoubleAnimation Storyboard.TargetName="WarningBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.5"/>
            <DoubleAnimation Storyboard.TargetName="WarningBarTransform" Storyboard.TargetProperty="Y"
                           To="-5" Duration="0:0:0.5">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Main bar expand animation (for hover/recording - slightly wider than sound waves) -->
        <Storyboard x:Key="MainBarExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Width"
                           To="100" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Height"
                           To="28" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Main bar contract animation (back to pill) -->
        <Storyboard x:Key="MainBarContractAnimation">
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Width"
                           To="70" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Height"
                           To="22" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Provider buttons show animation (right side) -->
        <Storyboard x:Key="ProviderButtonsShowAnimation">
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsPanel" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsTransform" Storyboard.TargetProperty="X"
                           From="-20" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Provider buttons hide animation (right side) -->
        <Storyboard x:Key="ProviderButtonsHideAnimation">
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsPanel" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsTransform" Storyboard.TargetProperty="X"
                           To="-20" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Left buttons show animation (settings/screenshot) -->
        <Storyboard x:Key="LeftButtonsShowAnimation">
            <DoubleAnimation Storyboard.TargetName="LeftButtonsPanel" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="LeftButtonsTransform" Storyboard.TargetProperty="X"
                           From="20" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Left buttons hide animation -->
        <Storyboard x:Key="LeftButtonsHideAnimation">
            <DoubleAnimation Storyboard.TargetName="LeftButtonsPanel" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="LeftButtonsTransform" Storyboard.TargetProperty="X"
                           To="20" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Provider button style -->
        <Style x:Key="ProviderButtonStyle" TargetType="Border">
            <Setter Property="Width" Value="28"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="CornerRadius" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="4,0,0,0"/>
        </Style>
    </Window.Resources>
    
    <Grid x:Name="RootGrid" VerticalAlignment="Bottom" HorizontalAlignment="Center"
          MouseLeftButtonDown="RootGrid_MouseLeftButtonDown"
          MouseMove="RootGrid_MouseMove"
          MouseLeftButtonUp="RootGrid_MouseLeftButtonUp">
        <Grid.RenderTransform>
            <TranslateTransform x:Name="DragTransform" X="0" Y="0"/>
        </Grid.RenderTransform>
        <StackPanel VerticalAlignment="Bottom">
            
            <!-- Warning Bar (separate layer, appears above transcript) -->
            <Border x:Name="WarningBar" 
                    Background="#F0ffa502" 
                    CornerRadius="8" 
                    Padding="16,8"
                    Margin="0,0,0,4"
                    Opacity="0"
                    Visibility="Collapsed"
                    HorizontalAlignment="Center">
                <Border.RenderTransform>
                    <TranslateTransform x:Name="WarningBarTransform" Y="10"/>
                </Border.RenderTransform>
                <Border.Effect>
                    <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                </Border.Effect>
                
                <TextBlock x:Name="WarningText" 
                           Text="" 
                           Foreground="#1a1a2e" 
                           FontFamily="Segoe UI Semibold" 
                           FontSize="12"
                           HorizontalAlignment="Center"/>
            </Border>
            
            <!-- Info Bar Container - overlays HintBar, TranscriptBar at same position -->
            <Grid Margin="0,0,0,4" HorizontalAlignment="Center">
                <!-- Transcript Bar - ClipToBounds ensures content doesn't overflow rounded corners -->
                <Border x:Name="TranscriptBar" 
                        Background="#F0121820" 
                        CornerRadius="8" 
                        Padding="16,8"
                        Opacity="0"
                        Visibility="Collapsed"
                        MaxHeight="280"
                        ClipToBounds="True"
                        HorizontalAlignment="Center">
                    <Border.RenderTransform>
                        <TranslateTransform x:Name="TranscriptBarTransform" Y="10"/>
                    </Border.RenderTransform>
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <!-- ScrollViewer - Hidden scrollbar to prevent layout jitter, but still scrollable -->
                    <ScrollViewer x:Name="TranscriptScrollViewer"
                                  VerticalScrollBarVisibility="Hidden"
                                  HorizontalScrollBarVisibility="Disabled">
                        <!-- TextBlock with inline cursor - same font as hint bar -->
                        <TextBlock x:Name="TranscriptText" 
                                   Foreground="#8892b0" 
                                   FontFamily="Segoe UI" 
                                   FontSize="12"
                                   FontWeight="Normal"
                                   TextWrapping="Wrap"
                                   MaxWidth="600"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Top">
                            <Run x:Name="TranscriptRun" Text=""/>
                            <InlineUIContainer x:Name="CursorContainer" BaselineAlignment="Center">
                                <Border x:Name="TypingCursor" 
                                        Width="2" Height="14" 
                                        Background="#ff6b9d" 
                                        CornerRadius="1"
                                        Visibility="Collapsed"
                                        Margin="1,0,0,0"/>
                            </InlineUIContainer>
                        </TextBlock>
                    </ScrollViewer>
                </Border>
                
                <!-- Hint Bar (shows on hover) - same position as transcript -->
                <Border x:Name="HintBar" 
                        Background="#F0121820" 
                        CornerRadius="8" 
                        Padding="16,8"
                        Opacity="0"
                        HorizontalAlignment="Center">
                    <Border.RenderTransform>
                        <TranslateTransform x:Name="HintBarTransform" Y="10"/>
                    </Border.RenderTransform>
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <TextBlock x:Name="HintText" HorizontalAlignment="Center">
                        <Run Text="Click or hold " Foreground="#8892b0" FontFamily="Segoe UI" FontSize="12"/>
                        <Run x:Name="HotkeyText" Text="caps" Foreground="#ff6b9d" FontFamily="Segoe UI Semibold" FontSize="12"/>
                        <Run Text=" to start dictating" Foreground="#8892b0" FontFamily="Segoe UI" FontSize="12"/>
                    </TextBlock>
                </Border>
            </Grid>
            
            <!-- Main bar and buttons container -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                
                <!-- Left Side Buttons (Settings, Screenshot) - fade in when hovered -->
                <StackPanel x:Name="LeftButtonsPanel" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center"
                            Opacity="0">
                    <StackPanel.RenderTransform>
                        <TranslateTransform x:Name="LeftButtonsTransform" X="20"/>
                    </StackPanel.RenderTransform>
                    
                    <!-- Settings Button -->
                    <Border x:Name="SettingsButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="#E6121820"
                            ToolTip="Settings"
                            Margin="0,0,4,0"
                            MouseLeftButtonDown="SettingsButton_Click">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="6" Opacity="0.2" ShadowDepth="1"/>
                        </Border.Effect>
                        <!-- Settings gear icon -->
                        <Grid>
                            <Ellipse Width="20" Height="20"
                                     StrokeThickness="2"
                                     Stroke="#8892b0">
                                <Ellipse.Fill>
                                    <SolidColorBrush Color="#8892b0" Opacity="0.2"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Text="âš™" 
                                       Foreground="#8892b0" 
                                       FontSize="11"
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                    
                    <!-- Screenshot Context Button -->
                    <Border x:Name="ScreenshotButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="#E6121820"
                            ToolTip="Screenshot Context (disabled)"
                            Margin="0,0,4,0"
                            MouseLeftButtonDown="ScreenshotButton_Click">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="6" Opacity="0.2" ShadowDepth="1"/>
                        </Border.Effect>
                        <!-- Camera/Screenshot icon -->
                        <Grid>
                            <Ellipse x:Name="ScreenshotIndicator" 
                                     Width="20" Height="20"
                                     StrokeThickness="2"
                                     Stroke="#6b7280">
                                <Ellipse.Fill>
                                    <SolidColorBrush Color="#6b7280" Opacity="0.2"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock x:Name="ScreenshotIcon" 
                                       Text="ðŸ“·" 
                                       Foreground="#6b7280" 
                                       FontSize="10"
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                </StackPanel>
                
                <!-- Main Voice Bar (always visible) - pill shape when idle, expands on hover/recording -->
                <Border x:Name="MainBar" 
                        Background="#E6121820" 
                        CornerRadius="11"
                        Width="70" Height="22"
                        Cursor="Hand">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="8" Opacity="0.25" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <!-- Voice wave bars container - animated by code based on audio level -->
                    <StackPanel x:Name="VoiceBarsPanel" 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Center" 
                                VerticalAlignment="Center">
                        <Rectangle x:Name="Bar1" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar2" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar3" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar4" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar5" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar6" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar7" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar8" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar9" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                
                <!-- AI Provider Buttons (fade in when hovered) -->
                <StackPanel x:Name="ProviderButtonsPanel" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center"
                            Opacity="0">
                    <StackPanel.RenderTransform>
                        <TranslateTransform x:Name="ProviderButtonsTransform" X="-20"/>
                    </StackPanel.RenderTransform>
                    
                    <!-- ChatGPT Button -->
                    <Border x:Name="ChatGPTButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="#E6121820"
                            ToolTip="ChatGPT"
                            MouseLeftButtonDown="ChatGPTButton_Click">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="6" Opacity="0.2" ShadowDepth="1"/>
                        </Border.Effect>
                        <!-- ChatGPT icon - green circle with stylized "G" -->
                        <Grid>
                            <Ellipse x:Name="ChatGPTIndicator" 
                                     Width="20" Height="20"
                                     StrokeThickness="2"
                                     Stroke="#10a37f">
                                <Ellipse.Fill>
                                    <SolidColorBrush Color="#10a37f" Opacity="0.2"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Text="G" 
                                       Foreground="#10a37f" 
                                       FontFamily="Segoe UI Semibold" 
                                       FontSize="11"
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                    
                    <!-- Gemini Button -->
                    <Border x:Name="GeminiButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="#E6121820"
                            ToolTip="Gemini"
                            MouseLeftButtonDown="GeminiButton_Click">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="6" Opacity="0.2" ShadowDepth="1"/>
                        </Border.Effect>
                        <!-- Gemini icon - blue circle with sparkle -->
                        <Grid>
                            <Ellipse x:Name="GeminiIndicator" 
                                     Width="20" Height="20"
                                     StrokeThickness="2"
                                     Stroke="#4285f4">
                                <Ellipse.Fill>
                                    <SolidColorBrush Color="#4285f4" Opacity="0.2"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Text="âœ¦" 
                                       Foreground="#4285f4" 
                                       FontSize="12"
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                    
                    <!-- Notion Button -->
                    <Border x:Name="NotionButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="#E6121820"
                            ToolTip="Notion"
                            MouseLeftButtonDown="NotionButton_Click">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="6" Opacity="0.2" ShadowDepth="1"/>
                        </Border.Effect>
                        <!-- Notion icon - black circle with "N" -->
                        <Grid>
                            <Ellipse x:Name="NotionIndicator" 
                                     Width="20" Height="20"
                                     StrokeThickness="2"
                                     Stroke="#000000">
                                <Ellipse.Fill>
                                    <SolidColorBrush Color="#000000" Opacity="0.2"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Text="N" 
                                       Foreground="#000000" 
                                       FontFamily="Segoe UI Semibold" 
                                       FontSize="11"
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                </StackPanel>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
