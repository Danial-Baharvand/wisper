<Window x:Class="WisperFlow.DictationBar"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WisperFlow"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        Focusable="False"
        ShowActivated="False"
        WindowStartupLocation="Manual">
    
    <Window.Resources>
        <!-- Hint bar expand animation -->
        <Storyboard x:Key="HintExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="HintBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="HintBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Hint bar collapse animation (no From values to prevent flash) -->
        <Storyboard x:Key="HintCollapseAnimation">
            <DoubleAnimation Storyboard.TargetName="HintBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="HintBarTransform" Storyboard.TargetProperty="Y"
                           To="10" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Transcript bar expand animation (same as hint bar) -->
        <Storyboard x:Key="TranscriptExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="TranscriptBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="TranscriptBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Transcript bar collapse animation (no From values to prevent flash) -->
        <Storyboard x:Key="TranscriptCollapseAnimation">
            <DoubleAnimation Storyboard.TargetName="TranscriptBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="TranscriptBarTransform" Storyboard.TargetProperty="Y"
                           To="10" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Warning bar fade in animation -->
        <Storyboard x:Key="WarningFadeInAnimation">
            <DoubleAnimation Storyboard.TargetName="WarningBar" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.3"/>
            <DoubleAnimation Storyboard.TargetName="WarningBarTransform" Storyboard.TargetProperty="Y"
                           From="10" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Warning bar fade out animation -->
        <Storyboard x:Key="WarningFadeOutAnimation">
            <DoubleAnimation Storyboard.TargetName="WarningBar" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.5"/>
            <DoubleAnimation Storyboard.TargetName="WarningBarTransform" Storyboard.TargetProperty="Y"
                           To="-5" Duration="0:0:0.5">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Main bar expand animation (for hover/recording - slightly wider than sound waves) -->
        <Storyboard x:Key="MainBarExpandAnimation">
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Width"
                           To="100" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Height"
                           To="28" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Main bar contract animation (back to pill) -->
        <Storyboard x:Key="MainBarContractAnimation">
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Width"
                           To="70" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="MainBar" Storyboard.TargetProperty="Height"
                           To="22" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Provider buttons show animation (right side) -->
        <Storyboard x:Key="ProviderButtonsShowAnimation">
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsPanel" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsTransform" Storyboard.TargetProperty="X"
                           From="-20" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Provider buttons hide animation (right side) -->
        <Storyboard x:Key="ProviderButtonsHideAnimation">
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsPanel" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="ProviderButtonsTransform" Storyboard.TargetProperty="X"
                           To="-20" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Left buttons show animation (settings/screenshot) -->
        <Storyboard x:Key="LeftButtonsShowAnimation">
            <DoubleAnimation Storyboard.TargetName="LeftButtonsPanel" Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="LeftButtonsTransform" Storyboard.TargetProperty="X"
                           From="20" To="0" Duration="0:0:0.25">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Left buttons hide animation -->
        <Storyboard x:Key="LeftButtonsHideAnimation">
            <DoubleAnimation Storyboard.TargetName="LeftButtonsPanel" Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetName="LeftButtonsTransform" Storyboard.TargetProperty="X"
                           To="20" Duration="0:0:0.15"/>
        </Storyboard>
        
        <!-- Provider button style with animated selection state -->
        <Style x:Key="ProviderButtonStyle" TargetType="Border">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="4,0,0,0"/>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX"
                                               To="1.1" Duration="0:0:0.15">
                                    <DoubleAnimation.EasingFunction>
                                        <CubicEase EasingMode="EaseOut"/>
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY"
                                               To="1.1" Duration="0:0:0.15">
                                    <DoubleAnimation.EasingFunction>
                                        <CubicEase EasingMode="EaseOut"/>
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX"
                                               To="1" Duration="0:0:0.15">
                                    <DoubleAnimation.EasingFunction>
                                        <CubicEase EasingMode="EaseOut"/>
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY"
                                               To="1" Duration="0:0:0.15">
                                    <DoubleAnimation.EasingFunction>
                                        <CubicEase EasingMode="EaseOut"/>
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- Icon selection pulse animation (applied programmatically) -->
        <Storyboard x:Key="IconSelectPulseAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0.6" To="1" Duration="0:0:0.8" AutoReverse="True">
                <DoubleAnimation.EasingFunction>
                    <SineEase EasingMode="EaseInOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Icon bounce animation for selection -->
        <Storyboard x:Key="IconBounceAnimation">
            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX"
                           From="1" To="1.2" Duration="0:0:0.1" AutoReverse="True">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY"
                           From="1" To="1.2" Duration="0:0:0.1" AutoReverse="True">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </Window.Resources>
    
    <Grid x:Name="RootGrid" VerticalAlignment="Bottom" HorizontalAlignment="Center"
          MouseLeftButtonDown="RootGrid_MouseLeftButtonDown"
          MouseMove="RootGrid_MouseMove"
          MouseLeftButtonUp="RootGrid_MouseLeftButtonUp">
        <Grid.RenderTransform>
            <TranslateTransform x:Name="DragTransform" X="0" Y="0"/>
        </Grid.RenderTransform>
        <StackPanel VerticalAlignment="Bottom">
            
            <!-- Warning Bar (separate layer, appears above transcript) -->
            <Border x:Name="WarningBar" 
                    Background="#F0ffa502" 
                    CornerRadius="8" 
                    Padding="16,8"
                    Margin="0,0,0,4"
                    Opacity="0"
                    Visibility="Collapsed"
                    HorizontalAlignment="Center">
                <Border.RenderTransform>
                    <TranslateTransform x:Name="WarningBarTransform" Y="10"/>
                </Border.RenderTransform>
                <Border.Effect>
                    <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                </Border.Effect>
                
                <TextBlock x:Name="WarningText" 
                           Text="" 
                           Foreground="#1a1a2e" 
                           FontFamily="Segoe UI Semibold" 
                           FontSize="12"
                           HorizontalAlignment="Center"/>
            </Border>
            
            <!-- Info Bar Container - overlays HintBar, TranscriptBar at same position -->
            <Grid Margin="0,0,0,4" HorizontalAlignment="Center">
                <!-- Transcript Bar - ClipToBounds ensures content doesn't overflow rounded corners -->
                <Border x:Name="TranscriptBar" 
                        Background="#F0121820" 
                        CornerRadius="8" 
                        Padding="16,8"
                        Opacity="0"
                        Visibility="Collapsed"
                        MaxHeight="280"
                        ClipToBounds="True"
                        HorizontalAlignment="Center">
                    <Border.RenderTransform>
                        <TranslateTransform x:Name="TranscriptBarTransform" Y="10"/>
                    </Border.RenderTransform>
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <!-- ScrollViewer - Hidden scrollbar to prevent layout jitter, but still scrollable -->
                    <ScrollViewer x:Name="TranscriptScrollViewer"
                                  VerticalScrollBarVisibility="Hidden"
                                  HorizontalScrollBarVisibility="Disabled">
                        <!-- TextBlock with inline cursor - same font as hint bar -->
                        <TextBlock x:Name="TranscriptText" 
                                   Foreground="#8892b0" 
                                   FontFamily="Segoe UI" 
                                   FontSize="12"
                                   FontWeight="Normal"
                                   TextWrapping="Wrap"
                                   MaxWidth="600"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Top">
                            <Run x:Name="TranscriptRun" Text=""/>
                            <InlineUIContainer x:Name="CursorContainer" BaselineAlignment="Center">
                                <Border x:Name="TypingCursor" 
                                        Width="2" Height="14" 
                                        Background="#ff6b9d" 
                                        CornerRadius="1"
                                        Visibility="Collapsed"
                                        Margin="1,0,0,0"/>
                            </InlineUIContainer>
                        </TextBlock>
                    </ScrollViewer>
                </Border>
                
                <!-- Hint Bar (shows on hover) - same position as transcript -->
                <Border x:Name="HintBar" 
                        Background="#F0121820" 
                        CornerRadius="8" 
                        Padding="16,8"
                        Opacity="0"
                        HorizontalAlignment="Center">
                    <Border.RenderTransform>
                        <TranslateTransform x:Name="HintBarTransform" Y="10"/>
                    </Border.RenderTransform>
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="12" Opacity="0.3" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <TextBlock x:Name="HintText" HorizontalAlignment="Center">
                        <Run Text="Click or hold " Foreground="#8892b0" FontFamily="Segoe UI" FontSize="12"/>
                        <Run x:Name="HotkeyText" Text="caps" Foreground="#ff6b9d" FontFamily="Segoe UI Semibold" FontSize="12"/>
                        <Run Text=" to start dictating" Foreground="#8892b0" FontFamily="Segoe UI" FontSize="12"/>
                    </TextBlock>
                </Border>
            </Grid>
            
            <!-- Main bar and buttons container -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                
                <!-- Left Side Buttons (Settings, Screenshot) - fade in when hovered -->
                <StackPanel x:Name="LeftButtonsPanel" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center"
                            Opacity="0">
                    <StackPanel.RenderTransform>
                        <TranslateTransform x:Name="LeftButtonsTransform" X="20"/>
                    </StackPanel.RenderTransform>
                    
                    <!-- Settings Button - Violet/Purple Material Design with Rotating Gear -->
                    <Border x:Name="SettingsButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="Transparent"
                            ToolTip="Settings"
                            Margin="0,0,4,0"
                            MouseLeftButtonDown="SettingsButton_Click">
                        <Border.Effect>
                            <DropShadowEffect x:Name="SettingsGlow" Color="#8b5cf6" BlurRadius="8" Opacity="0" ShadowDepth="0"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Selection ring with violet gradient -->
                            <Ellipse x:Name="SettingsRing" 
                                     Width="30" Height="30"
                                     StrokeThickness="2"
                                     Opacity="0"
                                     Visibility="Collapsed">
                                <Ellipse.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#a855f7" Offset="0"/>
                                        <GradientStop Color="#6366f1" Offset="0.5"/>
                                        <GradientStop Color="#a855f7" Offset="1"/>
                                    </LinearGradientBrush>
                                </Ellipse.Stroke>
                            </Ellipse>
                            <!-- Settings icon from PNG -->
                            <Ellipse x:Name="SettingsIndicator" Width="24" Height="24" RenderTransformOrigin="0.5,0.5">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="/Assets/Icons/settings.png" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                                <Ellipse.RenderTransform>
                                    <RotateTransform x:Name="SettingsGearRotation" Angle="0"/>
                                </Ellipse.RenderTransform>
                            </Ellipse>
                        </Grid>
                    </Border>
                    
                    <!-- Screenshot Button - Pink/Magenta Material Design with Camera Flash -->
                    <Border x:Name="ScreenshotButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="Transparent"
                            ToolTip="Screenshot Context"
                            Margin="0,0,4,0"
                            MouseLeftButtonDown="ScreenshotButton_Click">
                        <Border.Effect>
                            <DropShadowEffect x:Name="ScreenshotGlow" Color="#ec4899" BlurRadius="8" Opacity="0" ShadowDepth="0"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Selection ring with pink gradient -->
                            <Ellipse x:Name="ScreenshotRing" 
                                     Width="30" Height="30"
                                     StrokeThickness="2"
                                     Opacity="0"
                                     Visibility="Collapsed">
                                <Ellipse.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#f472b6" Offset="0"/>
                                        <GradientStop Color="#ec4899" Offset="0.5"/>
                                        <GradientStop Color="#db2777" Offset="1"/>
                                    </LinearGradientBrush>
                                </Ellipse.Stroke>
                            </Ellipse>
                            <!-- Flash overlay for capture animation -->
                            <Ellipse x:Name="ScreenshotFlash" Width="24" Height="24" 
                                     Fill="White" Opacity="0"/>
                            <!-- Restored Background Gradient for Transparent Icon (Named for Code Integration) -->
                            <Ellipse x:Name="ScreenshotIndicator" Width="24" Height="24" StrokeThickness="0">
                                <Ellipse.Fill>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#f472b6" Offset="0"/>
                                        <GradientStop Color="#ec4899" Offset="0.5"/>
                                        <GradientStop Color="#db2777" Offset="1"/>
                                    </LinearGradientBrush>
                                </Ellipse.Fill>
                            </Ellipse>
                            <!-- Screenshot camera icon (Explicit Image Control) -->
                            <Image Source="pack://application:,,,/Assets/Icons/camera.png" Width="24" Height="24" 
                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                   Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                        </Grid>
                    </Border>
                </StackPanel>
                
                <!-- Main Voice Bar (always visible) - pill shape when idle, expands on hover/recording -->
                <Border x:Name="MainBar" 
                        Background="#E6121820" 
                        CornerRadius="11"
                        Width="70" Height="22"
                        Cursor="Hand">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="8" Opacity="0.25" ShadowDepth="1"/>
                    </Border.Effect>
                    
                    <!-- Voice wave bars container - animated by code based on audio level -->
                    <StackPanel x:Name="VoiceBarsPanel" 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Center" 
                                VerticalAlignment="Center">
                        <Rectangle x:Name="Bar1" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar2" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar3" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar4" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar5" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar6" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar7" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar8" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                        <Rectangle x:Name="Bar9" Width="3" Height="4" Fill="#6b7280" RadiusX="1.5" RadiusY="1.5" Margin="2,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                
                <!-- AI Provider Buttons (fade in when hovered) -->
                <StackPanel x:Name="ProviderButtonsPanel" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center"
                            Opacity="0">
                    <StackPanel.RenderTransform>
                        <TranslateTransform x:Name="ProviderButtonsTransform" X="-20"/>
                    </StackPanel.RenderTransform>
                    
                    <!-- ChatGPT Button with Official OpenAI-style Icon -->
                    <Border x:Name="ChatGPTButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="Transparent"
                            ToolTip="ChatGPT"
                            MouseLeftButtonDown="ChatGPTButton_Click">
                        <Border.Effect>
                            <DropShadowEffect x:Name="ChatGPTGlow" Color="#67e8f9" BlurRadius="8" Opacity="0" ShadowDepth="0"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Animated selection ring (outer glow) -->
                            <Ellipse x:Name="ChatGPTRing" 
                                     Width="30" Height="30"
                                     StrokeThickness="2"
                                     Opacity="0"
                                     Visibility="Collapsed">
                                <Ellipse.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#FFFFFF" Offset="0"/>
                                        <GradientStop Color="#67e8f9" Offset="0.5"/>
                                        <GradientStop Color="#FFFFFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Ellipse.Stroke>
                            </Ellipse>
                            <!-- ChatGPT icon from PNG -->
                            <Ellipse x:Name="ChatGPTIndicator" Width="24" Height="24">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="/Assets/Icons/chatgpt.png" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Grid>
                    </Border>
                    
                    <!-- Gemini Button with Google-style gradient Icon -->
                    <Border x:Name="GeminiButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="Transparent"
                            ToolTip="Gemini"
                            MouseLeftButtonDown="GeminiButton_Click">
                        <Border.Effect>
                            <DropShadowEffect x:Name="GeminiGlow" Color="#4285f4" BlurRadius="8" Opacity="0" ShadowDepth="0"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Animated selection ring -->
                            <Ellipse x:Name="GeminiRing" 
                                     Width="30" Height="30"
                                     StrokeThickness="2"
                                     Opacity="0"
                                     Visibility="Collapsed">
                                <Ellipse.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#4285f4" Offset="0"/>
                                        <GradientStop Color="#ea4335" Offset="0.25"/>
                                        <GradientStop Color="#fbbc05" Offset="0.5"/>
                                        <GradientStop Color="#34a853" Offset="0.75"/>
                                        <GradientStop Color="#4285f4" Offset="1"/>
                                    </LinearGradientBrush>
                                </Ellipse.Stroke>
                            </Ellipse>
                            <!-- Gemini icon from PNG -->
                            <Ellipse x:Name="GeminiIndicator" Width="24" Height="24">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="/Assets/Icons/gemini.png" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Grid>
                    </Border>
                    
                    <!-- Notion Button - Elegant Black/White with Stylized N Logo -->
                    <Border x:Name="NotionButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="Transparent"
                            ToolTip="Notion"
                            MouseLeftButtonDown="NotionButton_Click">
                        <Border.Effect>
                            <DropShadowEffect x:Name="NotionGlow" Color="#FFFFFF" BlurRadius="8" Opacity="0" ShadowDepth="0"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Selection ring with silver gradient -->
                            <Ellipse x:Name="NotionRing" 
                                     Width="30" Height="30"
                                     StrokeThickness="2"
                                     Opacity="0"
                                     Visibility="Collapsed">
                                <Ellipse.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#FFFFFF" Offset="0"/>
                                        <GradientStop Color="#a0a0a0" Offset="0.5"/>
                                        <GradientStop Color="#FFFFFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Ellipse.Stroke>
                            </Ellipse>
                            <!-- Ink ripple overlay for animation -->
                            <Ellipse x:Name="NotionInkRipple" Width="24" Height="24" 
                                     Fill="#191919" Opacity="0" RenderTransformOrigin="0.5,0.5">
                                <Ellipse.RenderTransform>
                                    <ScaleTransform x:Name="NotionRippleScale" ScaleX="0.5" ScaleY="0.5"/>
                                </Ellipse.RenderTransform>
                            </Ellipse>
                            <!-- Notion icon from PNG -->
                            <Ellipse x:Name="NotionIndicator" Width="24" Height="24">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="/Assets/Icons/notion.png" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Grid>
                    </Border>
                    
                    <!-- Google Tasks Button - Blue with Large Checkmark and Circle Checkbox -->
                    <Border x:Name="GoogleTasksButton" 
                            Style="{StaticResource ProviderButtonStyle}"
                            Background="Transparent"
                            ToolTip="Google Tasks"
                            MouseLeftButtonDown="GoogleTasksButton_Click">
                        <Border.Effect>
                            <DropShadowEffect x:Name="GoogleTasksGlow" Color="#fbbf24" BlurRadius="8" Opacity="0" ShadowDepth="0"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Selection ring with Google blue gradient -->
                            <Ellipse x:Name="GoogleTasksRing" 
                                     Width="30" Height="30"
                                     StrokeThickness="2"
                                     Opacity="0"
                                     Visibility="Collapsed">
                                <Ellipse.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#FFFFFF" Offset="0"/>
                                        <GradientStop Color="#fbbf24" Offset="0.5"/>
                                        <GradientStop Color="#FFFFFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Ellipse.Stroke>
                            </Ellipse>
                            <!-- Completion flash overlay -->
                            <Ellipse x:Name="TasksCompletionFlash" Width="24" Height="24" 
                                     Fill="#34a853" Opacity="0"/>
                            <!-- Google Tasks icon from PNG -->
                            <Ellipse x:Name="GoogleTasksIndicator" Width="24" Height="24">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="/Assets/Icons/tasks.png" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Grid>
                    </Border>
                </StackPanel>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
